[
  {
    "objectID": "research.html",
    "href": "research.html",
    "title": "Research",
    "section": "",
    "text": "Current ResearchPrevious ResearchField Work\n\n\n\nForecasting organismal responses to heatwaves\n\n\n\n\n\n\nThe interactive widget above displays a thermal tolerance landscape of the Eastern oyster Crassostrea virginica displaying population survivorship as a function of temperature magnitude and exposure duration. I use these models to forecast individual and population-level responses to heatwave events. Why predict over heatwaves?\nHeatwaves, rather than gradual warming about the meteorological mean, are the driving abiotic factor behind marine invertebrate physiological stress. Because they highly variable in duration, magnitude and return time, it is difficult to predict organismal responses using traditional physiological exposure experiments.\nI use experiments to parameterize these thermal death time models, but primarily am using a simulation approach to understand how heatwaves of varying magnitude, duration, and return time affect organismal survivorship and metapopulation dynamics. I currently focus on the eastern Oyster Crassostrea virginica.\n\n\n\n\nMarine Local Adaptation - Master’s Research\nAs ecologists attempting to understand the impacts of climate change on marine organisms, we often neglect to consider how evolution may play a role in making organisms either more or less susceptible to climate change impacts. Organisms often have a plastic ability to change their physiology or behavior when subjected to different environmental conditions, but environmental changes that last for longer periods of time may drive evolutionary events, manifesting as a shift in genotypes. Countergradient variation is a type of local adaptation where organisms in cooler environments show comparatively higher growth rates than populations in warmer environments . This may result because of shorter growing seasons at high latitudes, where organisms must exploit small windows of ideal growing conditions. Therefore, if an evolutionary event were to drive a cool genotype organism to a warm genotype as a result of climate change, we can expect to see an overall decrease in organismal growth rates. This is an implication that is not fully appreciated in the field. \n\nThrough my Master’s research, I sought to better understand how populations of a single species may react differently to climate change. A common assumption of ecological niche models is trait homogeneity across a species, while in fact populations may inhabit diverse environments and be locally adapted to those conditions. The implication of this locally adapted reality is that some populations will be more resilient to climate change than others. I used the predatory marine snail Urosalpinx cinerea to ask these questions about intraspecific variation, specifically quantifying thermal tolerance and growth rates. This snail species is native to the Atlantic coast of the US and is an invasive species on the Pacific coast. In addition, it is a common marine predator on wild and cultured Eastern (Crassostrea virginica) and Pacific (C. gigas) oysters. My results will therefore not only inform coastal managers of projected U. cinerea sensitivity to climate change, but contribute to the growing body of knowledge surrounding how we predict organisms will react to climate change. ​\n\nThis research was recently published in Conservation Physiology (thermal tolerance and plasticity) and Proceedings of the Royal Society: B (growth rates, environmental drivers of adaptation). Research was supported by the American Malacological Society and the PADI Foundation.\nThis research provided pilot data for a successful NSF-funded grant by my Master’s advisor, Brian Cheng. Research continues at UMass with Project Uro!\n \n\n\nTropical Aquatic Ecology\n\n\n\nTagged Nerite snails to track migration rate\n\n\nIn the summer of 2017 I served as the Aquatic Ecologist for Operation Wallacea at their Dominica field site. In addition to working with high school students performing macroinvertebrate surveys, I developed a research program tracking the migration rates of a species of amphidromous freshwater snail, Nereina punctulata, across altitude and river flow rate. These hyper-abundant snails are likely extremely important for the transport of nutrients into oligotrophic headwaters of tropical streams. We found snails increase their migration rate low in the watershed, likely to avoid being swept downstream by freshets and to avoid large predators. Further, large snails were found more often in upstream areas, but smaller snails tended to exploit high flow environments once they had reached a few kilometers upstream. Antillean streams provide a unique opportunity to ask further questions on energy acquisition and predator avoidance. Research on Nereina migration is published in Aquatic Ecology.\n\n\nChameleon habitat use\n\n\n\nThe world’s second smallest lizard, Brookesia micra\n\n\nIn the spring of 2015, I performed research on the remote island of Nosy Hara, Madagascar, quantifying population density and habitat use of the cryptic leaf chameleon Brookesia micra. I was able to demonstrate novel habitat use by this primarily leaf-litter dwelling genus by showing the presence of this species on limestone outcroppings. Further, I performed the first intensive survey of the island for the species. Findings delivered to MNP, Nosy Hara National Park. See my Herpetological Conservation and Biology ​article for more!\n\n\n\n\n\n\n\n\n\n2023. Northwest and Southwest Madagascar. Intertidal biodiversity surveying and temperature logger deployment.\n2019, 2022. East Coast of the United States, Urosalpinx cinerea ​broodstock collection.\n2019. Gloucester, Massachusetts. Gloucester Marine Station, University of Massachusetts. Local adaptation in a marine snail.\n2018. Hurricane Island, Maine. Hurricane Island Center for Science and Leadership. Scallop aquaculture.\n2017. Rosalie, Dominica. Operation Wallacea. Macroinvertebrate diversity and freshwater snail migration.\n2016. Curaçao, Netherlands Antilles. Smithsonian Institute, National Museum of Natural History. Cryptic reef biodiversity project support.\n2016. El Dorado and Stanislaus National Forests, California. The Wilderness Society. Wilderness land cataloging and mapping.\n2015. Nosy Hara, Madagascar. School for International Training. Brookesia ​chameleon habitat use. ​\n2014. Kent Island, New Brunswick, Canada. Bowdoin Science Station. Intertidal biodiversity and invasive species cataloging.\n2012. Deep Creek, Eleuthera, The Bahamas. Cape Eleuthera Institute. Cage aquaculture and lionfish surveying."
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Thinking about thermal ecology and climate change",
    "section": "",
    "text": "When is it time to do intertidal fieldwork?\n\n\n\nR\n\n\ntides\n\n\nfieldwork\n\n\n\nA workflow and code to add tidal fieldwork to a digital calendar\n\n\n\nAndrew Villeneuve\n\n\nFeb 20, 2025\n\n\n\n\n\n\n\n\n\n\n\n\nOysters feeling the heat: Interview with News Center Maine\n\n\n\nmedia\n\n\nexperiments\n\n\nheatwaves\n\n\noysters\n\n\n\nMedia coverage of our ongoing extreme event work\n\n\n\nAndrew Villeneuve\n\n\nOct 22, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nNew Article in Journal of Animal Ecology - predicting survival over marine heatwaves\n\n\n\nheatwaves\n\n\npublication\n\n\n\nHeatwaves can be bad! But how bad?\n\n\n\nAndrew Villeneuve\n\n\nJun 11, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nMadagascar Field Season, 2023 Wrapup\n\n\n\nfieldwork\n\n\nexperiments\n\n\nheatwaves\n\n\n\nFine-scale temperature data in reef flat environments\n\n\n\nAndrew Villeneuve\n\n\nOct 3, 2023\n\n\n\n\n\n\n\n\n\n\n\n\nR tips: A function to obtain LT50 and LT50TDT from mortality data\n\n\n\nR\n\n\nexperiments\n\n\n\nNeed to get LT50 measures from your data quickly?\n\n\n\nAndrew Villeneuve\n\n\nApr 13, 2023\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2024-6-11- New JAE Article/index.html",
    "href": "posts/2024-6-11- New JAE Article/index.html",
    "title": "New Article in Journal of Animal Ecology - predicting survival over marine heatwaves",
    "section": "",
    "text": "I am thrilled to post that the first publication out of my PhD was recently published in Journal of Animal Ecology (Villeneuve and White (2024))! I authored a blog post on the journal’s blog, so I won’t repeat myself too much here. Rather, I want to go over why we did this study in the first place, and my top takeaways.\nThe kernel of an idea for this paper really took off when Easton and I were in Madagascar, and in between field work with our collaborators we talked a lot about extreme events and how to measure them, heatwaves in particular. Excellent work by Hobday et al. (2018) used statistical analysis of timeseries to understand when a heat event was anomalously extreme, and thus a heatwave. While such an approach allows one to account for variation in the temporal (duration) and thermal (intensity/magnitude) dimensions, the issue remained that comparing events with multiple measurement dimensions is difficult. Among the questions we asked was: what is worse, a long but mild heatwave, or a short but intense one? And, what if we could classify extreme events based on their ecological effects, rather than their statistical novelty?\nThere are a few different ways we could have gone around this. We could have taken an empirical approach, wherein I either observe organism responses in the field to different types of heatwave (data availability issues, not easily comparable between events) or I simulate heatwaves in the lab and observe responses (more controlled, but I could only replicate a dozen or so realistic heatwaves). We decided that, given the wide-open nature of the question to conduct an in silica simulation to generate a continuous response surface across many (527!) heatwaves varying in magnitude and duration. As our response, we selected survival resulting from thermal death time models (Rezende et al. (2020), Jørgensen et al. (2021)).\nNow, I will be the first to stop here and point out that heatwaves do not just affect survival. Temperature is a master factor, and can affect reproduction, morphology, development rate, metabolism, growth, and behavior, all of which we could have used as our response. I chose survival because 1) we have models of thermal tolerance that lend themselves really well to continuous time series that are just begging to be tested more extensively, and 2) frankly, other than species movement, death has a ton of public, conservation, and management visibility and is the ultimate ecological repercussion. When the 2021 Pacific Northwest heatdome hit Puget Sound, billions of intertidal organisms died on the shorelines. That is going to leave an indelible effect on the population dynamics of these species in the area. I also see mass mortality events from events like heatwaves as the first step in the march to local extirpation, and then global extinction. That may be a dramatic reading, especially since mobile animals can just move out of the way. But for sessile organisms (I’m thinking of you, corals and bivalves), there is no escape.\nAt this point, I am going to actually gloss over the results of our study (you can read the article or JAE blog entry to get those minutiae) and just deliver my big takeaways:\nSo, what’s next? This was obviously a simulation experiment, so someone needs to test some of our conclusions with empirical data! I will work on some aspects myself, but I feel this work stood on the shoulders of some really impressive and creative science (@ all teams I cite here) and can only presume more exciting work is waiting in the wings."
  },
  {
    "objectID": "posts/2024-6-11- New JAE Article/index.html#footnotes",
    "href": "posts/2024-6-11- New JAE Article/index.html#footnotes",
    "title": "New Article in Journal of Animal Ecology - predicting survival over marine heatwaves",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nOne thing I wish I cautioned more in my paper was that acute and chronic tolerance may not be an inherent tradeoff (see Rezende, Castañeda, and Santos (2014), Castañeda, Rezende, and Santos (2015) , Jørgensen, Malte, and Overgaard (2019), Kovacevic, Latombe, and Chown (2019) for the full debate). I am not picking sides at this point, other than saying there’s room for research from a more adaptive underpinnings angle in non-model species. The fact remains that variation in acute and chronic tolerance exists, and we don’t have any good explanations as to why that is so.↩︎"
  },
  {
    "objectID": "posts/2023-10-03-field season wrapup/index.html",
    "href": "posts/2023-10-03-field season wrapup/index.html",
    "title": "Madagascar Field Season, 2023 Wrapup",
    "section": "",
    "text": "In July 2023, QMEL PI Dr. Easton White and I joined our collaborator Dr. Mez Baker-Médard (ONJA lab, Middlebury College) in Madagascar to take part in field surveys related to our joint lab NSF project. The overarching goal of this grant is to understand how different social and gender dynamics within fishing villages affect the social adhesion, efficacy, and diversity of marine protected areas (MPAs). This work is driven by Dr. Baker-Médard’s incredible team of Malagasy students and field technicians who have been collecting social and ecological data in the island’s south for years. In 2023, the goal shifted from the long, linear barrier-reef system of the dry southern coast to the rocky fringing reef systems of the wet north.\n\n\n\nPirogues on Nosy Sakatia\n\n\nWe spent the first two weeks on the island of Nosy Be, where we met the Malagasy team and established a set of survey sites outside and within protected areas. These protected areas ranged from highly managed tourist sites, to areas restricted by fady, or social taboo, rather than centralized governance or NGOs. Protected and unprotected reefs were paired with a fishing village in which our research technicians would conduct social surveys across social and gender strata. I mainly joined the ecology team, where we deployed Baited Remote Underwater System (BRUV) cameras to collect mobile fish diversity data and conducted intertidal reef surveys. I got to observe a lot of different reefs on Nosy Be, ranging from beautiful Acropora reefs with healthy inshore seagrass to badly damaged boulder reefs with little structural diversity.\n\n\n\nPutting the ‘quantitative’ into empirical ecology\n\n\nAs an ecologist who thinks a lot about temperature, I was more keen to observe some fascinating intertidal oyster reefs that formed on boulders along shore. On these black rocks, exposed to the tropical sun, grew rock oysters (Saccostrea sp.) with wide bases and limited vertical protuberance above the rock itself. These oysters must reach scorching temperatures during the austral summer at low tide - is their body temperature much lower than the rock itself? How close to their thermal limits do these oysters live? Many fascinating thermal ecology questions to consider!\n\n\n\nSaccostrea - for invertebrate connoisseurs only\n\n\nFor the next leg of my trip, I was to deploy temperature loggers aross a depth gradient on the barrier reef system in the south for my thermal landscape project. We believe heatwaves will be more acutely felt in shallow, reef flat environments that are uncovered at the lowest monthly tides. People who fish on these flats will therefore experience the effects of heat stressed fish and invertebrate populations sooner than those fishing on deep reefs.\n\n\n\n\n\n\n\n\n\nSunset in Salary\n\n\n\n\n\n\n\nSome time may have been spent on the beach\n\n\n\n\n\nI flew from Nosy Be to Toliara, the great city of southwest Madagascar. From Toliara, I took a four hour 4x4 ride to the coastal village of Salary. Salary is one of the main southern research sites of the grant, and so was a natural location for logger deployment. I was able to deploy nine temperature loggers spanning the four major biophysical reef zones - flat, lagoon, reef crest, and reef slope. For this deployment, I chose ElectricBlue’s sleek encapsulated loggers that minimize the chance of battery compartment flooding and maximize data points. Once a suitable location was found, I zip-tied loggers directly into the reef matrix and took videos and GPS waypoints of their placement to aid in retrieval years from now. Nonetheless, it will be a challenge to retrieve these loggers: fishers, cyclones, and wave action can potentially remove the loggers from their locations. This is one of the challenges of deploying instruments in remote locations, where routine monitoring and purpose-built anchor systems are not possible.\n\n\n\nTemperature logger placement on a high wave-action forereef slope\n\n\nComing back to Madagascar was an incredible privilege, and I hope to work with in-country researchers to guide this research forward. Some of my more ambitious research ideas will likely not be logistically possible alone, and the ethics of flying back and forth once a year for data collection are questionable when so many capable scientists are in-country already. Nonetheless, I hope to be able to make it back at least one more time to keep the thermal landscape project moving forward.\n\n\n\n\n\n\n\n\n\nNga was the best driver\n\n\n\n\n\n\n\nFred was the best boat captain"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "I am a marine ecologist working at the nexus of thermal ecology, extreme events, and forecasting Hello",
    "section": "",
    "text": "I am a marine ecologist working at the nexus of thermal ecology, extreme events, and forecasting Hello"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "BioCV\n\n\nI am a global change marine ecologist working with data across scales of biological organization to better understand the effects of climate change on marine ecosystems and the people that depend on them. I specifically seek to combine empirical data of organismal physiology and distribution, environmental and extreme event data, and fisheries data into models of population dynamics under climate change.\nI am currently a Marine Biology PhD candidate at the University of New Hampshire in the Department of Biological Sciences, advised by Dr. Easton White in the Quantitative Marine Ecology Lab (QMEL).\nAndrew earned his bachelor’s in Biology from Bowdoin College in 2016 and his master’s in Environmental Conservation from the University of Massachusetts Amherst in 2021. At UMass Amherst, he worked in the  Marine Global Change Ecology Lab  lab with Dr. Brian Cheng understanding the role of local adaptation in driving intraspecific trait variation and climate sensitivity of the marine predatory gastropod Urosalpinx cinerea. He was a 2021 Knauss Marine Policy Fellow with NOAA Fisheries, where he supported efforts to incorporate traditional ecological knowledge from Inuit groups into an international agreement to prevent unregulated fishing in the Central Arctic Ocean, and developed communication materials about NOAA Fisheries surveys for the public and Congress.\n\nI have performed field work in Maine, California, New Brunswick, Mexico, Curacao, The Bahamas, and Madagascar working on a diverse set of systems and questions. I’ve performed common garden lab experiments, counted leaf chameleons, tracked freshwater snail migrations, worked on the genetics of invasive tunicates, mapped wilderness areas in the California Sierra Nevada, and grown farmed scallops.\n\n When not working on his research, Andrew likes to spend his time outdoors hiking, biking, kayaking, diving, getting lost, and taking nature walks."
  },
  {
    "objectID": "posts/2023-04-13-first-post/index.html",
    "href": "posts/2023-04-13-first-post/index.html",
    "title": "R tips: A function to obtain LT50 and LT50TDT from mortality data",
    "section": "",
    "text": "Occasionally on my blog, I will try and share some of the coding tips, tricks, and functions that I have come up with during my research. The function I am sharing today had it’s origins in my master’s research, when I needed to obtain LT50 measures from snails in a heatbar experiment. The heatbar (Fig. 1) created a ramp of temperatures using a heating element on one end and a cooling element (ice water bath) on the other. At the end of five hours of heating, I recorded final temperature and the alive/dead state of each snail in each position. This gave me data that had temperature and a binomial alive/dead state. A great exercise in binomial regression.\n\n\n\nFig. 1 Heatbar experimental setup used to measure LT50 in marine snails\n\n\nUsing the code I used for this LT50 analysis (which was published in Villeneuve, Komoroske, and Cheng (2021) ), I wanted to put together a function that automates a lot of the coding to extract LT50 measures from experimental groups. This is particularly useful in the context of scraping thermal limit data from older papers that maybe do not report or calculate LT50 from survivorship data at given temperatures.\n\n#A function to obtain LT50 values from survivorship curves across multiple temperature exposures\n#columns in dataframe should contain a temp, survival, and exposure (in minutes) column\nlibrary(MASS)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(brglm)\nlibrary(ggplot2)\n\n\nlt50fun&lt;-function(data){\n  exun&lt;-unique(data$exposure)\n  df&lt;-list()\n  for (i in 1:length(exun)){\n    tmp&lt;-filter(data,exposure==exun[[i]])\n    df[[i]]&lt;-tmp\n    \n  }\n  \n  modlist&lt;-list()\n  for (i in 1:length(df)){\n    mod&lt;-brglm(data=df[[i]],survival~temp,family=\"binomial\")\n    modlist[[i]]&lt;-mod\n  }\n  names(modlist)&lt;-exun\n  \n  LT50&lt;-list()\n  for(i in 1:length(modlist)){\n    lt&lt;-dose.p(modlist[[i]],p=0.5)[1]\n    LT50[[i]]&lt;-lt[[1]]\n  }\n  \n  lt50df&lt;-data.frame(as.data.frame(LT50)%&gt;%tidyr::gather(exposure,temp)%&gt;%mutate(exposure=exun)%&gt;%mutate(\"survival\"=0.5))%&gt;%mutate(\"type\"=\"LT50\")\n  \n  data&lt;-(rbind(data%&gt;%mutate(\"type\"=\"obs\"),lt50df))\n  \n  fit&lt;-brglm::brglm(survival~temp*exposure,data=data,family=\"binomial\")\n  pred_fit&lt;-data.frame(temp=seq(min(data$temp),max(data$temp),\n                                len=500),exposure=rep(unique(data$exposure),each=500))\n  pred_fit$survival&lt;-predict(fit, pred_fit,type=\"response\")\n  \n  \n  x&lt;-ggplot()+geom_point(data=data,aes(x=temp,y=survival,group=exposure))+geom_line(data=pred_fit,aes(x=temp,y=survival))+\n    facet_wrap(~exposure)+geom_point(data=data%&gt;%filter(type==\"LT50\"),aes(x=temp,y=survival,group=exposure),color=\"red\")+\n    geom_hline(yintercept=0.5,linetype=\"dashed\")+geom_text(data=data%&gt;%filter(type==\"LT50\"),aes(x=temp,y=survival,label=sprintf(fmt=\"%0.2f\",round(temp,digits=2))),nudge_y=0.03,nudge_x=-2)\n  \n  \n  par(ask=TRUE)\n  print(x)\n  return(lt50df)\n}\n\nThis function requires three columns in your dataframe, renamed as follows:\n\ntemp: temperature of treatment in degrees Celsius\nsurvival: pooled survivorship percentage for each temperature treatment\nexposure: can be any grouping of interest; I built the function considering different lengths of exposure in minutes\n\nLet’s try this function out on some raw data. I stumbled across a very cool paper comparing the effects of different aerial exposure durations on LT50 in the mangrove oyster Crassostrea rhizophorae (Littlewood (1989) ). The authors wanted to know if duration of emersion during low tide would impact thermal tolerance of mangrove oysters. Figure 3 displays percent survival of oyster groups exposed to three different emersion levels. I extracted data.\n\n\n\nFig. 2 Survival data of C. rhizophorae over emersion treatments. Data from Littlewood (1989) .\n\n\nI extracted survival using Webplot Digitzier (an amazing tool for anyone conducting metanalysis). Once I have a spreadsheet of survival, I can quickly read it into R and extract LT50 measures, and produce plots of survival curves.\n\nlittlewood_rhizo&lt;-read.csv(\"rhizo_surv.csv\")\n#conver to percentage scale\nlittlewood_rhizo$survival&lt;-littlewood_rhizo$survival/100\n\nrhizolt&lt;-lt50fun(littlewood_rhizo)\n\n\n\n\n\n\n\n\nCalculated LT50 values are also produced from this function.\n\n\n  exposure     temp survival type\n1     1440 37.61013      0.5 LT50\n2      400 43.54473      0.5 LT50\n3      120 48.38119      0.5 LT50\n\n\nThese LT50 measures are pretty close to what Littlewood (1989) calculated!\nWhile I would argue that LT50 is not a very useful measure of thermal tolerance (a future blog topic), this allows us to see that aerial exposure duration seems to cause a large decrease in LT50!\nLet me know if you have any improvements or comments.\n\n\n\n\n\nReferences\n\nLittlewood, D. Timothy J. 1989. “Thermal Tolerance and the Effects of Temperature on Air-Gaping in the Mangrove Oyster, Crassostrea Rhizophorae.” Comparative Biochemistry and Physiology Part A: Physiology 93 (2): 395–97. https://doi.org/10.1016/0300-9629(89)90054-6.\n\n\nVilleneuve, Andrew R, Lisa M Komoroske, and Brian S Cheng. 2021. “Diminished Warming Tolerance and Plasticity in Low-Latitude Populations of a Marine Gastropod.” Edited by Steve Cooke. Conservation Physiology 9 (1). https://doi.org/10.1093/conphys/coab039."
  },
  {
    "objectID": "posts/2024-22-10-News/index.html",
    "href": "posts/2024-22-10-News/index.html",
    "title": "Oysters feeling the heat: Interview with News Center Maine",
    "section": "",
    "text": "News Center Maine recently spoke with myself and my PI Easton White about our ongoing work building modeling tools to understand the impacts of extreme thermal events (heatwaves, coldwaves) on oyster populations in New Hampshire. The video attracted my first climate change denialist troll in the comments, which I feel may be a right of passage.\n\n\n\nDespite what some youtube comments would let you believe, the world’s oceans like the Gulf of Maine are rapidly warming due to the exponential release of greenhouse gases into the atmosphere from human activity."
  },
  {
    "objectID": "posts/2025-02-20-tide-calendar/index.html",
    "href": "posts/2025-02-20-tide-calendar/index.html",
    "title": "When is it time to do intertidal fieldwork?",
    "section": "",
    "text": "Ask any intertidal ecologist what they think of first when planning fieldwork, and they will respond with “when are the low tides?” Indeed, we love studying intertidal systems because they are such an accessible window into the marine world, while adding the dynamics of tidal cycles onto how species respond to their environment and other organisms.\nWhat any intertidal ecologist will also tell you is that tides wait for no one. The tides we often seek to access to the lowest tidal elevations for longer periods of time do not abide by the frivolous 9-5 schedule humans like to keep. Many an intertidal ecologist has stories of working at 3:30 AM in a cold drizzle because that simply is the best time to work for the next few weeks.\nRecently, another grad student and myself were trying to figure out how many days each week for the oncoming summer could we count on for decent field work. Normally, one might need to scroll through a tide app or the NOAA CO-OPS tide predictions website to identify these times, which can be tedious if one is trying to plan an entire field season. I decided there had to be a better way to automate this process, and of course there is - using R! Below, we will 1) collect tide prediction data, 2) filter times and tide heights during which we want to do field work, and 3) create an .ics calendar file that we can later add to commonly used internet calendars, like Outlook and Google Calendar.\nImportant note: the data we produce below is NOT intended for navigation purposes, ESPECIALLY for the predictions from subordinate stations!!"
  },
  {
    "objectID": "posts/2025-02-20-tide-calendar/index.html#rnoaa",
    "href": "posts/2025-02-20-tide-calendar/index.html#rnoaa",
    "title": "When is it time to do intertidal fieldwork?",
    "section": "rnoaa",
    "text": "rnoaa\nFirst, let’s download data using rnoaa. I am most interested in tides in Great Bay, NH, but sadly the closest site in the CO_OPS harmonics database is Seavey Island in the Piscataqua River. We lookup the station ID on the CO_OPS website, and add our dates of interest (we will use the same dates for all three R methods). Unfortunately, rnoaa only lets us download 31 days of data at a time, so we will need to set up a function to download each month.\nNOTE It looks like rnoaa is not being supported, and some functions are broken :( This code still works, but hopefully they come up with a replacement package.\n\ndl_months&lt;-data.frame(date_index=1:5,\nbegin_dates=c(20250501,20250601,20250701,20250801,20250901),\nend_dates=c(20250530,20250630,20250731,20250831,20250930))\n\nsite_id=8419870\n\nrnoaa_func&lt;-function(time_df){\n  rnoaa_output&lt;-coops_search(station_name = site_id,\n             begin_date = time_df$begin_dates,\n             end_date=time_df$end_dates,\n             product = \"predictions\", #we want tide PREDICTIONs. If we watned past heights, could use \"hourly_height\")\n             datum = \"MLLW\", #MLLW datum, which is standard at Seavey\n             units = \"metric\")$predictions%&gt;%# we will convert this to feet for us Americans later :)\n    dplyr::rename(datetime=t,tide_height=v)%&gt;%\n    dplyr::mutate(datetime=with_tz(as.POSIXct(datetime,format=\"%Y-%m-%d %H:%M\",tz=\"GMT\")),tz=\"America/New_York\")\n}\n\nsystem.time(\n  rnoaa_output_seavey&lt;-dl_months%&gt;%\n    group_by(date_index)%&gt;%\n    group_modify(~rnoaa_func(.x))%&gt;%\n    ungroup()\n)\n\n   user  system elapsed \n   0.99    0.06    3.14 \n\nhead(rnoaa_output_seavey)\n\n# A tibble: 6 × 4\n  date_index datetime            tide_height tz              \n       &lt;int&gt; &lt;dttm&gt;                    &lt;dbl&gt; &lt;chr&gt;           \n1          1 2025-04-30 20:00:00       0.019 America/New_York\n2          1 2025-04-30 20:06:00       0.016 America/New_York\n3          1 2025-04-30 20:12:00       0.018 America/New_York\n4          1 2025-04-30 20:18:00       0.023 America/New_York\n5          1 2025-04-30 20:24:00       0.032 America/New_York\n6          1 2025-04-30 20:30:00       0.046 America/New_York\n\n\nNote that the output of rnoaa defaults to every 6 minutes (10 obs/hour), which is an odd way to slice data IMO. You could always go back and select every 15 minutes, or interpolate to every minute. Also note that the datetime comes back to us in GMT only, so we must force a time zone conversion to eastern time. This does mean you won’t get the full last day of your time series due to the shift in the timezone, so worth adding an extra day just in case"
  },
  {
    "objectID": "posts/2025-02-20-tide-calendar/index.html#rtide",
    "href": "posts/2025-02-20-tide-calendar/index.html#rtide",
    "title": "When is it time to do intertidal fieldwork?",
    "section": "rtide",
    "text": "rtide\nLet’s try to do the same with rtide, getting closer to our field site if we can. Unfortunately, the Dover site is way upstream in the Cocheco River and not very relevant to us. So, let’s get the Seavey Island data again.\n\nstations&lt;-rtide::tide_stations()\nstations[str_detect(stations, \"New Hampshire\")] #some tidyverse magic to search for our state. \n\n[1] \"Dover, Cocheco River, Piscataqua River, New Hampshire\"\n[2] \"Fort Point, Portsmouth Harbor, New Hampshire\"         \n[3] \"Seavey Island, Portsmouth Harbor, New Hampshire\"      \n\n\n\nsystem.time(rtide_output_seavey&lt;-tide_height(\n  stations = \"Seavey Island, Portsmouth Harbor, New Hampshire\" ,\n  minutes = 6L, #nice! We can select our frequency. TO keep it standard in this post, let's do every 6mins\n  from = as.Date(\"2025-05-01\"),\n  to = as.Date(\"2025-09-30\"),\n  tz = \"America/New_York\",\n  harmonics = rtide::harmonics\n))\n\n   user  system elapsed \n  26.73    2.44   30.54 \n\nhead(rtide_output_seavey)\n\n# A tibble: 6 × 3\n  Station                                         DateTime            TideHeight\n  &lt;chr&gt;                                           &lt;dttm&gt;                   &lt;dbl&gt;\n1 Seavey Island, Portsmouth Harbor, New Hampshire 2025-05-01 00:00:00       2.13\n2 Seavey Island, Portsmouth Harbor, New Hampshire 2025-05-01 00:06:00       2.20\n3 Seavey Island, Portsmouth Harbor, New Hampshire 2025-05-01 00:12:00       2.27\n4 Seavey Island, Portsmouth Harbor, New Hampshire 2025-05-01 00:18:00       2.34\n5 Seavey Island, Portsmouth Harbor, New Hampshire 2025-05-01 00:24:00       2.40\n6 Seavey Island, Portsmouth Harbor, New Hampshire 2025-05-01 00:30:00       2.46"
  },
  {
    "objectID": "posts/2025-02-20-tide-calendar/index.html#marinetides",
    "href": "posts/2025-02-20-tide-calendar/index.html#marinetides",
    "title": "When is it time to do intertidal fieldwork?",
    "section": "MarineTides",
    "text": "MarineTides\nMarineTides is a very robust r package for getting ride information because 1) it uses data.table and is thus faster, and 2) allows the user to download subordiante data! This to me is critical, as it allows us to get a much closer station to our field site. Unfortunately, it only returns tide high and lows for subordinate sites, rather than predictions on a minute-basis.\nI do know the CO-OPS name for the subordinate site of interest is at Dover Point, so let’s get data from both Seavey Island and Dover Point\nBelow we get the tide data from Seavey Island\n\nsystem.time(MarineTides_output_seavey&lt;-MarineTides::tide_level(tide_station=\"Seavey Island\",\n                        start_date=\"2025-05-01\",\n                        end_date=\"2025-09-30\",\n                        data_interval = \"6-min\",\n                        tide_unit = \"meters\",\n                        timezone = \"America/New_York\",\n                        verbose=TRUE))\n\nSeavey Island is a reference station. Tide heights are\ncalculated from Seavey Island harmonic constituents. \n\nTides will be predicted from 2025-05-01 to 2025-09-30\n\n\n   user  system elapsed \n   1.70    0.05    1.83 \n\nhead(MarineTides_output_seavey)\n\n   station_code  station_name reference_station_code tide_type\n         &lt;char&gt;        &lt;char&gt;                 &lt;char&gt;    &lt;char&gt;\n1:      8419870 Seavey Island                8419870         P\n2:      8419870 Seavey Island                8419870         P\n3:      8419870 Seavey Island                8419870         P\n4:      8419870 Seavey Island                8419870         P\n5:      8419870 Seavey Island                8419870         P\n6:      8419870 Seavey Island                8419870         P\n             tide_time   tide_level\n                &lt;POSc&gt;      &lt;units&gt;\n1: 2025-05-01 00:00:00 2.098570 [m]\n2: 2025-05-01 00:06:00 2.166778 [m]\n3: 2025-05-01 00:12:00 2.233378 [m]\n4: 2025-05-01 00:18:00 2.298212 [m]\n5: 2025-05-01 00:24:00 2.361124 [m]\n6: 2025-05-01 00:30:00 2.421967 [m]\n\n\nLet’s do it again, but for a subordinate site Dover Point.\n\nsystem.time(MarineTides_output_dover&lt;-MarineTides::tide_level(tide_station=\"Dover Point\",\n                        start_date=\"2025-05-01\",\n                        end_date=\"2025-09-30\",\n                        tide_unit = \"meters\",\n                        timezone = \"America/New_York\",\n                        verbose=TRUE))\n\nDover Point is a subordinate station. The reference station, \nPortland, is located 76.35 km. away. Tide levels are \ncalculated from Portland harmonic constituents at one \nminute increments. Values for high and low tide are extracted, \nthen time and height offset corrections are applied to obtain the \nDover Point predictions. \n\nTides will be predicted from 2025-05-01 to 2025-09-30\n\n\nWarning in MarineTides::tide_level(tide_station = \"Dover Point\", start_date = \"2025-05-01\", : \nFor subordinate stations, only high and low tide values will be computed.\n\n\n   user  system elapsed \n   0.77    0.00    0.77 \n\nhead(MarineTides_output_dover)\n\n   station_code station_name reference_station_code tide_type\n         &lt;char&gt;       &lt;char&gt;                 &lt;char&gt;    &lt;char&gt;\n1:      8421897  Dover Point                8418150         H\n2:      8421897  Dover Point                8418150         L\n3:      8421897  Dover Point                8418150         H\n4:      8421897  Dover Point                8418150         L\n5:      8421897  Dover Point                8418150         H\n6:      8421897  Dover Point                8418150         L\n             tide_time      tide_level\n                &lt;POSc&gt;         &lt;units&gt;\n1: 2025-05-01 03:33:00  2.40556719 [m]\n2: 2025-05-01 09:57:00 -0.27604658 [m]\n3: 2025-05-01 16:18:00  2.04071289 [m]\n4: 2025-05-01 22:12:00  0.08293358 [m]\n5: 2025-05-02 04:33:00  2.28938917 [m]\n6: 2025-05-02 10:57:00 -0.15398555 [m]\n\n\nSo not only is this fast, but it gets us information on both harmonic and subordinate sites! So, I know why the programmers of MarineTides did not give us the capacity to predict tides from subordinate sites - we can only set subordinate site offsets based on the timing of high or low tides. If we tried to predict a subordinate station, we basically would just shift the time and height based on the offset. BUT we could do it, as long as we acknowledge that the tide harmonics are not calculated for these sites, and thus the shape of the tidal series in between extreme are not known. To quote the XTide developer David Flater, “All subordinate station predictions are approximate”\nQuick gut check to make sure our timezones are correct, and to see if any one method seems to depart from the other! They all look good, note again rnoaa has an earlier start date due to that GMT data fetch."
  },
  {
    "objectID": "posts/2025-02-20-tide-calendar/index.html#xtide",
    "href": "posts/2025-02-20-tide-calendar/index.html#xtide",
    "title": "When is it time to do intertidal fieldwork?",
    "section": "XTide",
    "text": "XTide\nXTide is an awesome UNIX tide prediction program that I use for much of our intertidal work because it provides predictions over harmonic and subordinate stations. Nifty!\nTo install, follow the instructions on the XTide installation page and the Port page for non-UNIX systems. It is a little involved, especially on Windows machines. I ended up installing a Windows Subsystem for Linux (WSL) to run Ubuntu. Here is another possibility using a BIOS builder. Note that you might want to download additional files, like the global shapefiles, if you want to use the GUI application as well as Xtide from the command line. I am not anywhere close to knowing what I am doing when it comes to Linux, so the help pages and google are your friends here.\nOnce you have Xtide downloaded, you can play around with the GUI which is fun!\n\n\n\nStarting screen of Xtide\n\n\n\n\n\nDover Point subordinate station in Xtide showing various data products\n\n\nYou can even directly download the data from these windows. But, I prefer just being able to get my data through command line. Take a look at the command line options, as well as the data types we can request. To translate this code into english, we are requesting data from\n\nDover Point between\nMay 1st, 2025 and\nSeptember 30th, 2025 in\n.csv format. The data type will be\n“medium rare,” which gives us datetime stamps along with tide height, and it will give it to us every\n15 minutes. Save the file at the location\n“xtide/2025summer_dover.csv”, which is a pre-existing, empty .csv file in my root Linux directory.\n\n\ntide -l \"Dover Point, Piscataqua River, New Hampshire\" -b \"2025-05-01 00:00\" -e \"2025-09-30 00:00\" -f c -m m -s \"00:15\" -o \"2025summer_dover.csv\"\n\nAlso, maybe you just want an .ics file of tide hight and lows? Simple!\n\ntide -l \"Dover Point, Piscataqua River, New Hampshire\" -b \"2025-05-01 00:00\" -e \"2025-09-30 00:00\" -f i -m c -o \"xtide/2025summer_dover.ics\"\n\nOnce we run the medium rare code (first code block), we have the requested tide predictions at our subordinate site. We are now ready to move on to creating a custom intertidal fieldwork calendar in R."
  },
  {
    "objectID": "publications.html",
    "href": "publications.html",
    "title": "Publications",
    "section": "",
    "text": "Villeneuve, Andrew R.; White, Easton R. (2024) “Predicting organismal response to marine heatwaves using dynamic thermal tolerance landscape models” Journal of Animal Ecology. 0021-8790, 1365-2656. DOI: 10.1111/1365-2656.14120         View Code & Data    Bentley, Blair P.;  Cheng, Brian S.; Brennan;  Reid S.;  Swenson, John D.;  Adkins, Jamie L.;  Villeneuve, Andrew R.;  Komoroske, Lisa M. (2024) “Successful Invasion Into New Environments Without Evidence of Rapid Adaptation by a Predatory Marine Gastropod” Molecular Ecology. 1365-294X. DOI: 10.1111/mec.17575         View     Sasaki, Matthew; Barley, Jordanna M.; Gignoux-Wolfsohn, Sarah; Hays, Cynthia G.; Kelly, Morgan W.; Putnam, Alysha B.; Sheth, Seema N.; Villeneuve, Andrew R.; Cheng, Brian S. (2022) “Greater evolutionary divergence of thermal limits within marine than terrestrial species” Nature Climate Change. 1758-6798. DOI: 10.1038/s41558-022-01534-y         View    Villeneuve, Andrew R.; Komoroske, Lisa M.; Cheng, Brian S (2021) “Diminished warming tolerance and plasticity in low-latitude populations of a marine gastropod” Conservation Physiology. 2051-1434. DOI: 10.1093/conphys/coab039         View Code & Data    Villeneuve, Andrew R.; Komoroske, Lisa M.; Cheng, Brian S. (2021) “Environment and phenology shape local adaptation in thermal performance” Proceedings of the Royal Society B: Biological Sciences. 1471-2954. DOI: 10.1098/rspb.2021.0741         View Code & Data    Barley, Jordanna M.; Cheng, Brian S.; Sasaki, Matthew; Gignoux-Wolfsohn, Sarah; Hays, Cynthia G.; Putnam, Alysha B.; Sheth, Seema; Villeneuve, Andrew R.; Kelly, Morgan (2021) “Limited plasticity in thermally tolerant ectotherm populations: evidence for a trade-off” Proceedings of the Royal Society B: Biological Sciences. 0962-8452, 1471-2954. DOI: 10.1098/rspb.2021.0765         View    Villeneuve, Andrew Robert; Thornhill, Ian; Eales, Jacqualyn (2019) “Upstream migration and altitudinal distribution patterns of Nereina punctulata (Gastropoda: Neritidae) in Dominica, West Indies” Aquatic Ecology. 1386-2588, 1573-5125. DOI: 10.1007/s10452-019-09683-7         View    Villeneuve, Andrew R (2017) “Habitat Selection and Population Density of the World’s Smallest Chameleon, Brookesia micra, on Nosy Hara, Madagascar” Herpetological Conservation and Biology. 2151-0733.         View    Wheelwright, Nathaniel T.; Taylor, Liam U.; West, Benjamin M.; Voss, Erin R.; Berzins, Sabine Y.; Villeneuve, Andrew R.; LeBlanc, Hannah R.; Leos, Victor B.; Mayne, Samuel J.; McCarthy, Sarah A.; Nagar, Shan J.; Watling, Jenna S. (2017) “Pupation Site Selection and Enemy Avoidance in the Introduced Pine Sawfly (Diprion similis )” Northeastern Naturalist. 1092-6194, 1938-5307. DOI: 10.1656/045.024.s705         View"
  }
]